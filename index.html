<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø±Ù‚Ø§Ù…</title>
  <style>
    :root{
      --bg:#0f172a; /* slate-900 */
      --card:#111827; /* gray-900 */
      --muted:#334155; /* slate-600 */
      --text:#e5e7eb; /* gray-200 */
      --accent:#22c55e; /* green-500 */
      --danger:#ef4444; /* red-500 */
      --warn:#f59e0b;  /* amber-500 */
      --link:#60a5fa;  /* blue-400 */
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#0b1025,#0f172a);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji"}
    a{color:var(--link);text-decoration:none}
    .container{max-width:1100px;margin:0 auto;padding:16px}
    header{position:sticky;top:0;background:rgba(15,23,42,.8);backdrop-filter:blur(8px);border-bottom:1px solid #1f2937;z-index:50}
    .nav{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px 0}
    .brand{display:flex;align-items:center;gap:12px}
    .brand img{width:44px;height:44px;border-radius:12px;object-fit:cover;border:1px solid #1f2937}
    .brand h1{font-size:18px;margin:0}
    .nav-links{display:flex;gap:8px;flex-wrap:wrap}
    .btn{padding:10px 14px;border-radius:12px;border:1px solid #1f2937;background:#0b1229;color:var(--text);cursor:pointer}
    .btn:hover{border-color:#334155}
    .btn.primary{background:var(--accent);color:#06210e;border-color:transparent}
    .btn.ghost{background:transparent}
    .btn.warn{background:var(--warn);color:#1f1300;border-color:transparent}
    .btn.danger{background:var(--danger);color:#2b0a0a;border-color:transparent}
    .grid{display:grid;gap:16px}
    .grid.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    .grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    @media (max-width:900px){.grid.cols-3{grid-template-columns:repeat(2,minmax(0,1fr))}}
    @media (max-width:640px){.grid.cols-3,.grid.cols-2{grid-template-columns:1fr}}
    .card{background:var(--card);border:1px solid #1f2937;border-radius:16px;box-shadow:0 10px 25px rgba(0,0,0,.3)}
    .card .p{padding:16px}
    .muted{color:#94a3b8}
    .field{display:flex;flex-direction:column;gap:6px;margin-bottom:10px}
    .input, select, textarea{background:#0b1229;border:1px solid #1f2937;border-radius:12px;padding:10px 12px;color:var(--text)}
    .input:focus, select:focus, textarea:focus{outline:2px solid #334155}
    .table{width:100%;border-collapse:collapse}
    .table th,.table td{padding:10px;border-bottom:1px solid #1f2937;text-align:right}
    .pill{display:inline-block;padding:4px 10px;border-radius:999px;font-size:12px;border:1px solid #1f2937}
    .pill.ok{background:rgba(34,197,94,.15)}
    .pill.no{background:rgba(239,68,68,.15)}
    .hero{display:grid;grid-template-columns:1.2fr .8fr;gap:18px;align-items:center;margin-top:16px}
    @media(max-width:900px){.hero{grid-template-columns:1fr}}
    .hero-visual{height:280px;background:radial-gradient(120px 120px at 20% 30%,#1d2a57,transparent 60%),radial-gradient(140px 140px at 80% 70%,#123860,transparent 60%);border-radius:18px;border:1px solid #1f2937}
    footer{padding:32px 0;color:#94a3b8;border-top:1px solid #1f2937;margin-top:32px}
    .badge{font-size:12px;background:#0b1229;border:1px solid #1f2937;border-radius:999px;padding:6px 10px;color:#a5b4fc}
    .hidden{display:none !important}
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand">
        <img id="siteLogo" src="https://i.postimg.cc/7ZP6hNL9/number-shop.png" alt="logo"/>
        <h1 id="siteName">Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø±Ù‚Ø§Ù…</h1>
        <span class="badge" id="liveBadge">Ø­ÙŠÙ‘ ÙˆÙ…Ø¨Ø§Ø´Ø±</span>
      </div>
      <nav class="nav-links">
        <a class="btn ghost" href="#/welcome">ØªØ±Ø­ÙŠØ¨</a>
        <a class="btn ghost" href="#/home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        <a class="btn ghost" href="#/faq">Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª</a>
        <a class="btn" id="goAdmin" href="#/admin">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <!-- Welcome Page -->
    <section id="page-welcome" class="page">
      <div class="hero">
        <div class="card p">
          <h2 id="welcomeTitle" style="margin-top:0">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ <span id="welcomeSiteName">Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø±Ù‚Ø§Ù…</span> ğŸ‘‹</h2>
          <p class="muted" id="welcomeSub">Ù†ÙˆÙØ± Ù„Ùƒ Ø£Ø±Ù‚Ø§Ù… ØªÙØ¹ÙŠÙ„ Ø¬Ø§Ù‡Ø²Ø© Ù…Ø¹ ØªØ­Ø¯ÙŠØ«Ø§Øª ÙÙˆØ±ÙŠØ© ÙˆØ¹Ø±ÙˆØ¶ Ø®Ø§ØµØ©.</p>
          <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:12px">
            <a href="#/home" class="btn primary">ØªØµÙØ­ Ø§Ù„Ø¹Ø±ÙˆØ¶</a>
            <a href="#/faq" class="btn">Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª</a>
          </div>
        </div>
        <div class="hero-visual"></div>
      </div>

      <div class="grid cols-3" style="margin-top:18px">
        <div class="card p">
          <h3>Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ«</h3>
          <p class="muted">Ø£ÙŠ ØªØºÙŠÙŠØ± Ù…Ù† Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ÙŠØ¸Ù‡Ø± Ù„Ù„Ø¬Ù…ÙŠØ¹ Ù…Ø¨Ø§Ø´Ø±Ø©.</p>
        </div>
        <div class="card p">
          <h3>Ù…Ø±ÙˆÙ†Ø© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</h3>
          <p class="muted">ØªØµÙ…ÙŠÙ… Ù…ØªØ¬Ø§ÙˆØ¨ ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ§Ù„ ÙˆØ§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ± ÙˆØ§Ù„ØªØ§Ø¨Ù„Øª.</p>
        </div>
        <div class="card p">
          <h3>Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</h3>
          <p class="muted">Ø²Ø± Ø·Ù„Ø¨ ÙŠØ±Ø³Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø±Ù‚Ù… Ø¥Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„.</p>
        </div>
      </div>
    </section>

    <!-- Home / Offers Page -->
    <section id="page-home" class="page hidden">
      <div class="card p" style="margin-top:16px">
        <div style="display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap">
          <div style="display:flex;gap:10px;align-items:center">
            <h2 style="margin:0">Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…ØªØ§Ø­Ø©</h2>
            <span class="pill" id="countBadge">0 Ø§Ù„Ù…ØªØ§Ø­</span>
          </div>
          <input id="search" class="input" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ø¯ÙˆÙ„Ø© Ø£Ùˆ Ø§Ù„Ø±Ù‚Ù…â€¦" />
        </div>
        <div id="offers" class="grid cols-3" style="margin-top:12px"></div>
      </div>
    </section>

    <!-- FAQ / Inquiries Page -->
    <section id="page-faq" class="page hidden">
      <div class="card p" style="margin-top:16px">
        <h2 style="margin-top:0">Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</h2>
        <details open>
          <summary>ÙƒÙŠÙ Ø£Ø·Ù„Ø¨ Ø±Ù‚Ù…Ø§Ù‹ØŸ</summary>
          <p class="muted">Ø§Ø®ØªØ± Ø§Ù„Ø±Ù‚Ù… Ø«Ù… Ø§Ø¶ØºØ· "Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨" Ù„Ø¥Ø±Ø³Ø§Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„.</p>
        </details>
        <details>
          <summary>ÙƒÙŠÙ Ø£Ø³ØªÙ„Ù… ÙƒÙˆØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ØŸ</summary>
          <p class="muted">Ø¨Ø¹Ø¯ Ø§Ù„Ø¯ÙØ¹ØŒ ÙŠØ±Ø³Ù„ Ù„Ùƒ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„ÙƒÙˆØ¯ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨. Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ ØªØªØ­Ø¯Ø« Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ÙˆÙ‚Ø¹.</p>
        </details>
        <details>
          <summary>Ù‡Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª ÙÙˆØ±ÙŠØ©ØŸ</summary>
          <p class="muted">Ù†Ø¹Ù…ØŒ Ø£ÙŠ ØªØ¹Ø¯ÙŠÙ„ Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ÙŠØ¸Ù‡Ø± ÙÙˆØ±Ø§Ù‹ Ù„ÙƒÙ„ Ø§Ù„Ø²ÙˆØ§Ø±.</p>
        </details>
      </div>
    </section>

    <!-- Admin Page -->
    <section id="page-admin" class="page hidden">
      <div class="card p" style="margin-top:16px">
        <h2 style="margin-top:0">Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</h2>

        <div id="adminLogin">
          <div class="grid cols-2">
            <div>
              <div class="field">
                <label>ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</label>
                <input id="adminPass" class="input" type="password" placeholder="********" />
              </div>
              <button class="btn primary" id="loginBtn">Ø¯Ø®ÙˆÙ„</button>
              <p class="muted" style="margin-top:8px">ØªÙ„Ù…ÙŠØ­: ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ù…Ù† Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„.</p>
            </div>
            <div class="card p">
              <h3 style="margin-top:0">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†</h3>
              <ul class="muted">
                <li>Ù‡Ø°Ù‡ Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø£Ø³Ø§Ø³ÙŠØ© (Ø¹Ù…ÙŠÙ„ ÙÙ‚Ø·). Ù„Ù„Ø£Ù…Ø§Ù† Ø§Ù„ÙƒØ§Ù…Ù„ Ø§Ø³ØªØ®Ø¯Ù… Ø®Ø§Ø¯Ù…Ø§Ù‹ Ø£Ùˆ Ù‚ÙˆØ§Ø¹Ø¯ Ø£Ù…Ø§Ù† Firestore Ù‚ÙˆÙŠØ©.</li>
                <li>Ù„Ø§ ØªØ´Ø§Ø±Ùƒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.</li>
              </ul>
            </div>
          </div>
        </div>

        <div id="adminPanel" class="hidden">
          <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px">
            <button class="btn" data-tab="tab-settings">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</button>
            <button class="btn" data-tab="tab-numbers">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø±Ù‚Ø§Ù…</button>
            <button class="btn" data-tab="tab-orders">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</button>
            <button class="btn warn" id="logoutBtn">Ø®Ø±ÙˆØ¬</button>
          </div>

          <!-- Settings -->
          <div id="tab-settings" class="card p">
            <h3 style="margin-top:0">Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</h3>
            <div class="grid cols-2">
              <div>
                <div class="field">
                  <label>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹</label>
                  <input id="setName" class="input" />
                </div>
                <div class="field">
                  <label>Ø±Ø§Ø¨Ø· Ø§Ù„Ø´Ø¹Ø§Ø±</label>
                  <input id="setLogo" class="input" />
                </div>
                <div class="field">
                  <label>Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ (Ù…Ø¹ Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø©)</label>
                  <input id="setWhatsapp" class="input" placeholder="Ù…Ø«Ø§Ù„: 9677XXXXXXX" />
                </div>
                <div class="field">
                  <label>ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„</label>
                  <input id="setNewPass" class="input" type="password" />
                </div>
                <button class="btn primary" id="saveSettings">Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</button>
              </div>
              <div>
                <p class="muted">ØªØ¸Ù‡Ø± Ù‡Ø°Ù‡ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£Ù…Ø§Ù… Ø§Ù„Ø¬Ù…ÙŠØ¹ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø­ÙØ¸.</p>
              </div>
            </div>
          </div>

          <!-- Numbers -->
          <div id="tab-numbers" class="card p hidden">
            <h3 style="margin-top:0">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø±Ù‚Ø§Ù…</h3>
            <div class="grid cols-2">
              <div class="card p">
                <h4 style="margin-top:0">Ø¥Ø¶Ø§ÙØ© / ØªØ¹Ø¯ÙŠÙ„</h4>
                <div class="field"><label>Ø§Ù„Ù…Ø¹Ø±Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„)</label><input id="numId" class="input" placeholder="Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºØ§Ù‹ Ù„Ù„Ø¥Ø¶Ø§ÙØ©"/></div>
                <div class="field"><label>Ø§Ù„Ø¯ÙˆÙ„Ø©</label><input id="numCountry" class="input" placeholder="Ø§Ù„ÙŠÙ…Ù†ØŒ Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©â€¦"/></div>
                <div class="field"><label>Ø§Ù„Ø±Ù‚Ù…</label><input id="numNumber" class="input" placeholder="7xxxxxxxx"/></div>
                <div class="field"><label>Ø§Ù„Ø³Ø¹Ø±</label><input id="numPrice" class="input" type="number" min="0" step="0.01"/></div>
                <div class="field"><label>Ù…ØªØ§Ø­ØŸ</label>
                  <select id="numAvailable">
                    <option value="true">Ù†Ø¹Ù…</option>
                    <option value="false">Ù„Ø§</option>
                  </select>
                </div>
                <button class="btn primary" id="saveNumber">Ø­ÙØ¸ Ø§Ù„Ø±Ù‚Ù…</button>
                <button class="btn danger" id="deleteNumber">Ø­Ø°Ù Ø¨Ø§Ù„Ù…Ø¹Ø±Ù</button>
              </div>

              <div>
                <table class="table" id="numbersTable">
                  <thead>
                    <tr><th>Ø§Ù„Ù…Ø¹Ø±Ù</th><th>Ø§Ù„Ø¯ÙˆÙ„Ø©</th><th>Ø§Ù„Ø±Ù‚Ù…</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th></tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- Orders -->
          <div id="tab-orders" class="card p hidden">
            <h3 style="margin-top:0">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h3>
            <table class="table" id="ordersTable">
              <thead>
                <tr><th>Ø§Ù„Ù…Ø¹Ø±Ù</th><th>Ø§Ù„Ø±Ù‚Ù…</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th><th>ÙˆØ§ØªØ³Ø§Ø¨</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="container">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap">
      <span id="footerText">Â© <span id="yearNow"></span> Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø±Ù‚Ø§Ù… â€“ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</span>
      <span class="muted">Ù†Ø³Ø®Ø© Ø£Ù…Ø§Ù…ÙŠØ© ÙÙ‚Ø· â€“ ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Firebase Ù„Ù„Ø¹Ù…Ù„ Ø§Ù„Ø­ÙŠ</span>
    </div>
  </footer>

  <!-- Firebase v9 (modular) -->
  <script type="module">
    // ====== 1) Ø¶Ø¹ Ù…ÙØ§ØªÙŠØ­ Firebase Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ Ù‡Ù†Ø§ ======
    // Ø£Ù†Ø´Ø¦ Ù…Ø´Ø±ÙˆØ¹Ø§Ù‹ Ù…Ù† console.firebase.google.com Ø«Ù… ÙØ¹Ù‘Ù„ Firestore Ø£Ùˆ Realtime Database.
    // Ù‡Ø°Ø§ Ø§Ù„Ù…Ø«Ø§Ù„ ÙŠØ³ØªØ®Ø¯Ù… Firestore.
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getFirestore, doc, getDoc, setDoc, updateDoc, onSnapshot, collection, addDoc, deleteDoc, query, orderBy } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "PASTE_API_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // ====== 2) Ø¹Ù†Ø§ØµØ± DOM ======
    const pages = {
      welcome: document.getElementById('page-welcome'),
      home: document.getElementById('page-home'),
      faq: document.getElementById('page-faq'),
      admin: document.getElementById('page-admin')
    };

    const siteNameEl = document.getElementById('siteName');
    const siteLogoEl = document.getElementById('siteLogo');
    const welcomeSiteNameEl = document.getElementById('welcomeSiteName');
    const welcomeTitleEl = document.getElementById('welcomeTitle');
    const welcomeSubEl = document.getElementById('welcomeSub');
    const offersWrap = document.getElementById('offers');
    const countBadge = document.getElementById('countBadge');
    const searchInput = document.getElementById('search');

    const adminLogin = document.getElementById('adminLogin');
    const adminPanel = document.getElementById('adminPanel');
    const adminPass = document.getElementById('adminPass');
    const loginBtn = document.getElementById('loginBtn');
    const logoutBtn = document.getElementById('logoutBtn');

    const setName = document.getElementById('setName');
    const setLogo = document.getElementById('setLogo');
    const setWhatsapp = document.getElementById('setWhatsapp');
    const setNewPass = document.getElementById('setNewPass');
    const saveSettings = document.getElementById('saveSettings');

    const numId = document.getElementById('numId');
    const numCountry = document.getElementById('numCountry');
    const numNumber = document.getElementById('numNumber');
    const numPrice = document.getElementById('numPrice');
    const numAvailable = document.getElementById('numAvailable');
    const saveNumber = document.getElementById('saveNumber');
    const deleteNumberBtn = document.getElementById('deleteNumber');
    const numbersTable = document.querySelector('#numbersTable tbody');

    const ordersTable = document.querySelector('#ordersTable tbody');

    const footerYear = document.getElementById('yearNow');
    footerYear.textContent = new Date().getFullYear();

    // ====== 3) Ø¨ÙŠØ§Ù†Ø§Øª Firestore ======
    const settingsRef = doc(db, 'meta', 'settings');
    const numbersCol = collection(db, 'numbers');
    const ordersCol = collection(db, 'orders');

    // Ø£ÙˆÙ„ ØªØ´ØºÙŠÙ„: ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
    async function ensureDefaults(){
      const snap = await getDoc(settingsRef);
      if(!snap.exists()){
        await setDoc(settingsRef, {
          siteName: 'Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø±Ù‚Ø§Ù…',
          logoUrl: 'https://i.postimg.cc/7ZP6hNL9/number-shop.png',
          welcomeTitle: 'Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ğŸ‘‹',
          welcomeSub: 'Ù†ÙˆÙØ± Ù„Ùƒ Ø£Ø±Ù‚Ø§Ù… ØªÙØ¹ÙŠÙ„ Ø¬Ø§Ù‡Ø²Ø© Ù…Ø¹ ØªØ­Ø¯ÙŠØ«Ø§Øª ÙÙˆØ±ÙŠØ© ÙˆØ¹Ø±ÙˆØ¶ Ø®Ø§ØµØ©.',
          whatsappAdmin: '9677XXXXXXXX',
          adminPassword: 'admin123', // Ù„Ù„ØªØ¬Ø±Ø¨Ø© â€“ ØºÙŠÙ‘Ø±Ù‡Ø§ ÙÙˆØ±Ø§Ù‹
          footerText: 'Â© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©',
          updatedAt: Date.now()
        });
      }
    }

    // Ø¨Ø« Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù„ÙŠØªØºÙŠØ± ÙƒÙ„ Ø´ÙŠØ¡ Ù„Ù„Ø¬Ù…ÙŠØ¹
    onSnapshot(settingsRef, (docSnap)=>{
      if(docSnap.exists()){
        const s = docSnap.data();
        siteNameEl.textContent = s.siteName || 'Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø±Ù‚Ø§Ù…';
        welcomeSiteNameEl.textContent = s.siteName || 'Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø±Ù‚Ø§Ù…';
        if(s.welcomeTitle) welcomeTitleEl.firstChild && (welcomeTitleEl.firstChild.textContent = s.welcomeTitle + ' ');
        if(s.welcomeSub) welcomeSubEl.textContent = s.welcomeSub;
        if(s.logoUrl) siteLogoEl.src = s.logoUrl;
        document.getElementById('footerText').innerHTML = s.footerText || '';

        // Ø¹Ø¨Ù‘ÙŠ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù†Ø¯ ÙØªØ­ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
        setName.value = s.siteName || '';
        setLogo.value = s.logoUrl || '';
        setWhatsapp.value = s.whatsappAdmin || '';
      }
    });

    // Ø¨Ø« Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ø£Ø±Ù‚Ø§Ù…
    const qNumbers = query(numbersCol, orderBy('country','asc'));
    onSnapshot(qNumbers, (qs)=>{
      const list = [];
      numbersTable.innerHTML = '';
      offersWrap.innerHTML = '';
      qs.forEach(d=>{
        const v = d.data();
        list.push({id:d.id, ...v});
        // Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${d.id}</td><td>${v.country||''}</td><td>${v.number||''}</td><td>${(v.price||0)}$</td><td>${v.available?'<span class="pill ok">Ù…ØªØ§Ø­</span>':'<span class="pill no">ØºÙŠØ± Ù…ØªØ§Ø­</span>'}</td>`;
        tr.onclick = ()=>{
          numId.value = d.id;
          numCountry.value = v.country||'';
          numNumber.value = v.number||'';
          numPrice.value = v.price||0;
          numAvailable.value = v.available? 'true':'false';
          window.location.hash = '#/admin';
          switchTab('tab-numbers');
        };
        numbersTable.appendChild(tr);

        // Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…ØªØ¬Ø± (Ù„Ù„Ø²ÙˆØ§Ø±)
        if(v.available){
          const card = document.createElement('div');
          card.className = 'card p';
          card.innerHTML = `
            <div style="display:flex;justify-content:space-between;gap:8px;align-items:center">
              <div>
                <div class="muted">${v.country||'â€”'}</div>
                <div style="font-size:20px;font-weight:600">${v.number||''}</div>
              </div>
              <div style="text-align:left">
                <div class="pill ok">Ù…ØªØ§Ø­</div>
                <div style="margin-top:8px;font-weight:700">${(v.price||0)}$</div>
              </div>
            </div>
            <div class="field" style="margin-top:10px">
              <label>Ø§Ø³Ù…Ùƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
              <input class="input buyerName" placeholder="Ø£ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ"/>
            </div>
            <button class="btn primary orderBtn">Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
          `;
          const orderBtn = card.querySelector('.orderBtn');
          orderBtn.addEventListener('click', ()=> placeOrder({id:d.id, ...v}, card));
          offersWrap.appendChild(card);
        }
      });
      countBadge.textContent = `${list.filter(x=>x.available).length} Ø§Ù„Ù…ØªØ§Ø­`;
    });

    // Ø¨Ø« Ù…Ø¨Ø§Ø´Ø± Ù„Ù„Ø·Ù„Ø¨Ø§Øª (Ø¥Ø¯Ø§Ø±Ø©)
    onSnapshot(ordersCol, (qs)=>{
      ordersTable.innerHTML = '';
      qs.forEach(d=>{
        const v = d.data();
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${d.id}</td>
          <td>${v.number||''}</td>
          <td>${v.price||0}$</td>
          <td>${v.buyerName||'-'}</td>
          <td>${v.buyerWhatsApp? ('+'+v.buyerWhatsApp):'-'}</td>
          <td><span class="pill ${v.status==='done'?'ok': v.status==='pending'?'':'no'}">${v.status||'new'}</span></td>
          <td>
            <button class="btn warn" data-done="${d.id}">ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…</button>
            <button class="btn danger" data-cancel="${d.id}">Ø¥Ù„ØºØ§Ø¡</button>
          </td>`;
        ordersTable.appendChild(tr);
      });
    });

    // Ø­Ø¯Ø« Ø£Ø²Ø±Ø§Ø± Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨
    ordersTable.addEventListener('click', async (e)=>{
      const done = e.target.getAttribute('data-done');
      const cancel = e.target.getAttribute('data-cancel');
      if(done){ await updateDoc(doc(db,'orders',done), {status:'done'}); }
      if(cancel){ await updateDoc(doc(db,'orders',cancel), {status:'canceled'}); }
    });

    // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
    saveSettings.addEventListener('click', async ()=>{
      const payload = {
        siteName: setName.value.trim() || 'Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø±Ù‚Ø§Ù…',
        logoUrl: setLogo.value.trim(),
        whatsappAdmin: setWhatsapp.value.trim(),
        updatedAt: Date.now()
      };
      if(setNewPass.value.trim()) payload.adminPassword = setNewPass.value.trim();
      await updateDoc(settingsRef, payload);
      setNewPass.value = '';
      alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª âœ…');
    });

    // Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ø±Ù‚Ù…
    saveNumber.addEventListener('click', async ()=>{
      const val = {
        country: (numCountry.value||'').trim(),
        number: (numNumber.value||'').trim(),
        price: Number(numPrice.value||0),
        available: numAvailable.value === 'true'
      };
      if(numId.value.trim()){
        await updateDoc(doc(db,'numbers',numId.value.trim()), val);
        alert('ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« âœ…');
      } else {
        const ref = await addDoc(numbersCol, val);
        numId.value = ref.id;
        alert('ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© âœ…');
      }
    });

    // Ø­Ø°Ù Ø±Ù‚Ù…
    deleteNumberBtn.addEventListener('click', async ()=>{
      const id = numId.value.trim();
      if(!id) return alert('Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¹Ø±Ù Ø£ÙˆÙ„Ø§Ù‹');
      await deleteDoc(doc(db,'numbers',id));
      alert('ØªÙ… Ø§Ù„Ø­Ø°Ù ğŸ—‘ï¸');
      numId.value = numCountry.value = numNumber.value = numPrice.value = '';
      numAvailable.value = 'true';
    });

    // ÙÙ„ØªØ±Ø© Ø§Ù„Ø¨Ø­Ø«
    searchInput?.addEventListener('input', ()=>{
      const q = searchInput.value.trim().toLowerCase();
      [...offersWrap.children].forEach(card=>{
        const txt = card.textContent.toLowerCase();
        card.style.display = txt.includes(q)? 'block':'none';
      });
    });

    // ÙˆØ¶Ø¹ Ø§Ù„Ø·Ù„Ø¨: ÙƒØªØ§Ø¨Ø© Ø¥Ù„Ù‰ Firestore + ÙØªØ­ ÙˆØ§ØªØ³Ø§Ø¨
    async function placeOrder(item, card){
      const sSnap = await getDoc(settingsRef);
      const s = sSnap.data()||{};
      const adminWa = (s.whatsappAdmin||'').replace(/\D/g,'');
      if(!adminWa){
        alert('Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ØºÙŠØ± Ù…Ø¶Ø¨ÙˆØ· Ø¨Ø¹Ø¯.');
        return;
      }
      const buyerName = card.querySelector('.buyerName')?.value.trim() || '';
      const payload = {
        numberId: item.id,
        number: item.number,
        price: item.price,
        buyerName,
        buyerWhatsApp: '',
        status: 'pending',
        createdAt: Date.now()
      };
      const ref = await addDoc(ordersCol, payload);
      const text = encodeURIComponent(`Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ #${ref.id}\nØ±Ù‚Ù…: ${item.number} (${item.country})\nØ§Ù„Ø³Ø¹Ø±: ${item.price}$\nØ§Ù„Ø§Ø³Ù…: ${buyerName||'-'}\nØ±Ø§Ø¨Ø· Ø§Ù„Ø·Ù„Ø¨: ${location.origin + location.pathname + '#/admin'}`);
      const waUrl = `https://wa.me/${adminWa}?text=${text}`;
      window.open(waUrl,'_blank');
    }

    // ====== 4) ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø¨Ø³ÙŠØ· Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ (Ø¹Ù…ÙŠÙ„ ÙÙ‚Ø·) ======
    let isAdmin = false;
    loginBtn.addEventListener('click', async ()=>{
      const sSnap = await getDoc(settingsRef);
      const s = sSnap.data()||{};
      const ok = (adminPass.value.trim() === (s.adminPassword||''));
      if(ok){
        isAdmin = true;
        localStorage.setItem('isAdmin','1');
        adminLogin.classList.add('hidden');
        adminPanel.classList.remove('hidden');
      } else {
        alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
      }
    });
    logoutBtn.addEventListener('click', ()=>{
      isAdmin = false; localStorage.removeItem('isAdmin');
      adminPanel.classList.add('hidden');
      adminLogin.classList.remove('hidden');
    });

    // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¬Ù„Ø³Ø©
    if(localStorage.getItem('isAdmin')==='1'){
      adminLogin.classList.add('hidden');
      adminPanel.classList.remove('hidden');
    }

    // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø¯Ø§Ø®Ù„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
    function switchTab(id){
      ['tab-settings','tab-numbers','tab-orders'].forEach(t=>{
        document.getElementById(t).classList.toggle('hidden', t!==id);
      })
    }
    document.querySelectorAll('#adminPanel [data-tab]').forEach(btn=>{
      btn.addEventListener('click', ()=> switchTab(btn.getAttribute('data-tab')));
    });

    // ====== 5) ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ØµÙØ­Ø§Øª (SPA Ø¹Ø¨Ø± hash) ======
    function route(){
      const hash = location.hash || '#/welcome';
      Object.values(pages).forEach(p=>p.classList.add('hidden'));
      if(hash.startsWith('#/welcome')) pages.welcome.classList.remove('hidden');
      else if(hash.startsWith('#/home')) pages.home.classList.remove('hidden');
      else if(hash.startsWith('#/faq')) pages.faq.classList.remove('hidden');
      else if(hash.startsWith('#/admin')) pages.admin.classList.remove('hidden');
      else pages.welcome.classList.remove('hidden');
    }
    window.addEventListener('hashchange', route);

    // ====== 6) ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ÙŠ ======
    ensureDefaults().then(()=>{
      route();
    });
  </script>
</body>
</html>
